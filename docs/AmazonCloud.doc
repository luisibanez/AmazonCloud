This file describes how to use Amazon Cloud machine image created by modENCODE DCC to launch instance with three applications installed.
These applications include uniform processing/peak calling pipeline from the command line, Faceted Browser and Wiki. 
If you have any questions about this, please email help@modencode.org.


Step 1.  Create your Amazon EC2 account if you don't already have one.  Go to http://aws.amazon.com, click 
on 'Sign Up Now' and follow the instructions.  Keep your Amazon access and secret keys handy because 
you will need them in Step 4.  

Step 2. Use git to clone or check out the latest copy of the modENCODE DCC Amazon source code and tools.

  > cd 
  > git https://github.com/qtrinh/AmazonCloud.git
  > cd AmazonCloud
 

Step 3. Edit 'env.sh' and set your JAVA_HOME, AWS_ACCESS_KEY, and AWS_SECRET_KEY environment variables.  
Set your environments by doing the following:

 > vi env.sh 

 Modify all the requirements listed above, then execute following command.  

 > .  env.sh 

 Test and make sure your environments are set correctly by doing the following:

 > ec2-describe-regions

  If you are able to run the above command then your environments are set correctly.  If you are not able to 
run the above command then see the below link on how to setup your EC2 API tools:

   http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/SettingUp_CommandLine.html


Step 4. Edit 'config.txt' to include the following configuration values for Amazon instance.
This config file will be used in Step 5 with bin/create_instance.pl to launch the instance.

 KEY_PAIR: YOUR_KEY_NAME
    Keypair name to use to login to instance.  Default value is 'YOUR_KEY_NAME'.

 SECURITY_GROUP: YOUR_SECURITY_GROUP_NAME
    Security group to be used by instance.  Default value is 'YOUR_SECURITY_GROUP_NAME'.
    
 INSTANCE_NAME: YOUR_INSTANCE_NAME
    Label or name of your modENCODE instance. Default value is 'YOUR_INSTANCE_NAME'.
 
 AUTHORIZED_PORTS: YOUR_PORT_NUMBERS
 	Ports to be enabled in your security group to allow access to your instance through those ports.

AMI: - |- ami-c65dcbaf (Uniform Processing/Peak Calling Image, 2013-02-08)
 	   | 																		(*** These two images will be combined this week. ***)
 	   |- ami-edeb4384 (modENCODE Data Image v14 (26 Jul 2012))
    
    Latest modENCODE DCC AMI's ID

 INSTANCE_TYPE: m1.medium
    Amazon instance type.  Default value is 'm1.medium'. 
    For other Amazon instance types, see http://aws.amazon.com/ec2/instance-types

 REGION: us-east-1
    Amazon regioin to create modENCODE instance in.  Default value is 'us-east-1'.

 AVAILABILITY_ZONE: us-east-1a
    Amazon zone to create modENCODE instance in.  Default value is 'us-east-1a'.


Step 5. Launch an instance of modENCODE AMI using bin/create_instance.pl.  Run the script by itself to 
get its usage.  To launch modENCODE AMI instance with the configuration file created in Step 4, do the 
following:

  > bin/create_instance.pl config.txt 

  Your modENCODE AMI instance may take a couple of minutes to start.  For your convenience, this script 
also outputs your instance URL, and the ssh command to login to your modENCODE instance.  
The instance URL, and the ssh command should look something like:

Galaxy URL:
  ec2-xx-xx-xx-xx.compute-1.amazonaws.com

ssh command:
  ssh -i KEY_FILE.pem ubuntu@ec2-xx-xx-xx-xx.compute-1.amazonaws.com


